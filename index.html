<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Recherche dans le tableau des ind√©pendants</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <!-- Required Stylesheets -->
    <link
            type="text/css"
            rel="stylesheet"
            href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
            type="text/css"
            rel="stylesheet"
            href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"
    />

    <!-- Load polyfills to support older browsers -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2CIntersectionObserver"></script>

    <!-- Required scripts -->
    <script src="https://unpkg.com/vue@latest/dist/vue.js"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
</head>
<body>
    <div id="app">
        <form class="form-inline" v-on:submit.prevent="filterList" >
            <b-form-input class="col-10" v-model="contentFilterInput" placeholder="Introduisez ici votre filtre de recherche!"></b-form-input>
            <input type="submit" class="col-2 btn btn-primary" >
        </form>
        <b-table id="lookupTable" primary-key="matricule" :items="items" :fields="fields" :sort-by.sync="sortBy"
                 :sort-desc.sync="sortDesc" :per-page="perPage" :current-page="currentPage"
                 :filter="contentFilter" @filtered="onFiltered" :filter-included-fields="contentFilterIncludedFields"
                 bordered striped hover ></b-table>
        <p class="mt-3">Total Rows: {{ rows }}</p>
        <div v-show="rows > pageLimit">
            <div class="mt-1">
                <b-pagination v-model="currentPage" pills :total-rows="rows" :per-page="perPage" :limit="pageLimit" aria-controls="lookupTable" first-number last-number size="lg"></b-pagination>
            </div>
        </div>
    </div>
    <script>
        window.app = new Vue({
            el: '#app',
            data() {
                return {
                    rows: 0,
                    contentFilter: null,
                    contentFilterInput: null,
                    contentFilterIncludedFields: ['matricule'],
                    pageLimit: 5,
                    perPage: 15,
                    currentPage: 1,
                    sortBy: 'age',
                    sortDesc: false,
                    fields: FIELDSJSONREPLACE,
                    items: ITEMSJSONREPLACE
                }
            },
            mounted() {
                this.rows = this.items.length
            },
            beforeDestroy() {
                clearTimeout(this.$_debounceTimer)
            },
            methods: {
                filterList() {
                    // Trigger pagination to update the number of buttons/pages due to filtering
                    clearTimeout(this.$_debounceTimer);
                    this.$_debounceTimer = setTimeout(() => {
                        this.contentFilter = this.contentFilterInput;
                    }, 100)
                },
                onFiltered(filteredItems) {
                    // Trigger pagination to update the number of buttons/pages due to filtering
                    this.rows = filteredItems.length;
                    this.currentPage = 1;
                },
            }
        })
    </script>
</body>
</html>